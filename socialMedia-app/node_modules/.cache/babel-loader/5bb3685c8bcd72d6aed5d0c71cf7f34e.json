{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\AGOMEZ\\\\OneDrive\\\\Documents\\\\GitHub\\\\horus-app\\\\socialMedia-app\\\\src\\\\App.jsx\",\n    _s = $RefreshSig$();\n\nimport Login from \"./pages/login/Login\";\nimport Register from \"./pages/register/Register\";\nimport { Outlet, Navigate, useNavigate, Routes, Route } from \"react-router-dom\";\nimport Navbar from \"./components/navbar/Navbar\";\nimport LeftBar from \"./components/leftBar/LeftBar\";\nimport RightBar from \"./components/rightBar/RightBar\";\nimport Home from \"./pages/home/Home\";\nimport Profile from \"./pages/profile/Profile\";\nimport \"./style.scss\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { DarkModeContext } from \"./context/darkModeContext\";\nimport * as authService from \"../src/services/auth\";\nimport * as userService from \"../src/services/user\";\nimport NotFound from \"./pages/notFound/NotFound\";\nimport * as postService from \"../src/services/post\";\nimport PostDetailsPage from \"./pages/postDetails/PostDetailsPage\";\nimport PostForm from \"./pages/postDetails/PostForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const navigate = useNavigate();\n  const {\n    darkMode\n  } = useContext(DarkModeContext);\n  /* get logged user data from local storage */\n\n  const [accessToken, setAccessToken] = useState(authService.getAccessToken());\n  const [posts, setPosts] = useState([]);\n  const [currentUser, setCurrentUser] = useState([]);\n  useEffect(() => {\n    if (accessToken) {\n      postService.fetchPosts().then(response => {\n        setPosts(response.data);\n      });\n      userService.me().then(response => {\n        setCurrentUser(response.data);\n      });\n    }\n  }, []);\n\n  const handleLogin = async (usernameOrEmail, password) => {\n    try {\n      const response = await authService.loginUsername(usernameOrEmail, password);\n      localStorage.setItem(\"accessToken\", response.data.accessToken);\n      setAccessToken(response.data.accessToken);\n      alert(\"Login successfully\");\n      postService.fetchPosts().then(response => {\n        setPosts(response.data);\n      });\n      userService.me().then(response => {\n        setCurrentUser(response.data);\n      });\n      navigate(\"/\");\n    } catch (error) {\n      if (error.response && error.response.status === 400) {\n        // alert(error.response.data.message);\n        try {\n          const response = await authService.loginEmail(usernameOrEmail, password);\n          localStorage.setItem(\"accessToken\", response.data.accessToken);\n          setAccessToken(response.data.accessToken);\n          alert(\"Login successfully\");\n          postService.fetchPosts().then(response => {\n            setPosts(response.data);\n          });\n          userService.me().then(response => {\n            setCurrentUser(response.data);\n          });\n          navigate(\"/\");\n        } catch (error) {\n          if (error.response && error.response.status === 400) {\n            alert(error.response.data.message);\n          }\n        }\n      }\n    }\n  };\n\n  const handleLogout = () => {\n    authService.logout();\n    setAccessToken(null);\n    navigate(\"/login\");\n  };\n\n  const handleSubmit = post => {\n    try {\n      postService.addPost(post).then(response => {\n        postService.fetchPosts().then(response => {\n          setPosts(response.data);\n          alert(\"Shared Post!\");\n        });\n      });\n    } catch (error) {\n      if (error.response && error.response.status === 400) {\n        alert(error.response.data.message);\n      }\n    }\n  };\n\n  const Layout = _ref => {\n    let {\n      currentUser\n    } = _ref;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `theme-${darkMode ? \"dark\" : \"light\"}`,\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {\n        onLogout: handleLogout,\n        currentUser: currentUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(LeftBar, {\n          currentUser: currentUser\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            flex: 6\n          },\n          children: /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 37\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(RightBar, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Routes, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        path: \"/\",\n        element: accessToken ? /*#__PURE__*/_jsxDEV(Layout, {\n          currentUser: currentUser\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 15\n        }, this),\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          element: /*#__PURE__*/_jsxDEV(Navigate, {\n            to: \"/home\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 36\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/home\",\n          element: /*#__PURE__*/_jsxDEV(Home, {\n            posts: posts,\n            onSubmit: handleSubmit,\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/profile/:id/posts\",\n          element: /*#__PURE__*/_jsxDEV(Profile, {\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 22\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"users/me\",\n          element: /*#__PURE__*/_jsxDEV(Profile, {\n            onSubmit: handleSubmit,\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/posts/:id\",\n          element: /*#__PURE__*/_jsxDEV(PostDetailsPage, {\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 22\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/editPost/:id\",\n          element: /*#__PURE__*/_jsxDEV(PostForm, {\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 22\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/login\",\n        element: /*#__PURE__*/_jsxDEV(Login, {\n          onLogin: handleLogin\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 39\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/register\",\n        element: /*#__PURE__*/_jsxDEV(Register, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 42\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/not-found\",\n        element: /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 43\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"*\",\n        element: /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/not-found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 34\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(App, \"fj5S10Xw2TX4HfrMKyxSfiJc1dA=\", false, function () {\n  return [useNavigate];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/AGOMEZ/OneDrive/Documents/GitHub/horus-app/socialMedia-app/src/App.jsx"],"names":["Login","Register","Outlet","Navigate","useNavigate","Routes","Route","Navbar","LeftBar","RightBar","Home","Profile","useContext","useEffect","useState","DarkModeContext","authService","userService","NotFound","postService","PostDetailsPage","PostForm","App","navigate","darkMode","accessToken","setAccessToken","getAccessToken","posts","setPosts","currentUser","setCurrentUser","fetchPosts","then","response","data","me","handleLogin","usernameOrEmail","password","loginUsername","localStorage","setItem","alert","error","status","loginEmail","message","handleLogout","logout","handleSubmit","post","addPost","Layout","display","flex"],"mappings":"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","sourcesContent":["import Login from \"./pages/login/Login\";\r\nimport Register from \"./pages/register/Register\";\r\nimport { Outlet, Navigate, useNavigate, Routes, Route } from \"react-router-dom\";\r\nimport Navbar from \"./components/navbar/Navbar\";\r\nimport LeftBar from \"./components/leftBar/LeftBar\";\r\nimport RightBar from \"./components/rightBar/RightBar\";\r\nimport Home from \"./pages/home/Home\";\r\nimport Profile from \"./pages/profile/Profile\";\r\nimport \"./style.scss\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { DarkModeContext } from \"./context/darkModeContext\";\r\nimport * as authService from \"../src/services/auth\";\r\nimport * as userService from \"../src/services/user\";\r\nimport NotFound from \"./pages/notFound/NotFound\";\r\nimport * as postService from \"../src/services/post\";\r\nimport PostDetailsPage from \"./pages/postDetails/PostDetailsPage\";\r\nimport PostForm from \"./pages/postDetails/PostForm\";\r\n\r\nfunction App() {\r\n  const navigate = useNavigate();\r\n\r\n  const { darkMode } = useContext(DarkModeContext);\r\n\r\n  /* get logged user data from local storage */\r\n  const [accessToken, setAccessToken] = useState(authService.getAccessToken());\r\n  const [posts, setPosts] = useState([]);\r\n  const [currentUser, setCurrentUser] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (accessToken) {\r\n      postService.fetchPosts().then((response) => {\r\n        setPosts(response.data);\r\n      });\r\n      userService.me().then((response) => {\r\n        setCurrentUser(response.data);\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const handleLogin = async (usernameOrEmail, password) => {\r\n    try {\r\n      const response = await authService.loginUsername(\r\n        usernameOrEmail,\r\n        password\r\n      );\r\n\r\n      localStorage.setItem(\"accessToken\", response.data.accessToken);\r\n      setAccessToken(response.data.accessToken);\r\n      alert(\"Login successfully\");\r\n\r\n      postService.fetchPosts().then((response) => {\r\n        setPosts(response.data);\r\n      });\r\n      userService.me().then((response) => {\r\n        setCurrentUser(response.data);\r\n      });\r\n      navigate(\"/\");\r\n    } catch (error) {\r\n      if (error.response && error.response.status === 400) {\r\n        // alert(error.response.data.message);\r\n        try {\r\n          const response = await authService.loginEmail(\r\n            usernameOrEmail,\r\n            password\r\n          );\r\n          localStorage.setItem(\"accessToken\", response.data.accessToken);\r\n          setAccessToken(response.data.accessToken);\r\n          alert(\"Login successfully\");\r\n\r\n          postService.fetchPosts().then((response) => {\r\n            setPosts(response.data);\r\n          });\r\n          userService.me().then((response) => {\r\n            setCurrentUser(response.data);\r\n          });\r\n          navigate(\"/\");\r\n        } catch (error) {\r\n          if (error.response && error.response.status === 400) {\r\n            alert(error.response.data.message);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    authService.logout();\r\n    setAccessToken(null);\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  const handleSubmit = (post) => {\r\n    try {\r\n      postService.addPost(post).then((response) => {\r\n        postService.fetchPosts().then((response) => {\r\n          setPosts(response.data);\r\n          alert(\"Shared Post!\");\r\n        });\r\n      });\r\n    } catch (error) {\r\n      if (error.response && error.response.status === 400) {\r\n        alert(error.response.data.message);\r\n      }\r\n    }\r\n  };\r\n\r\n  const Layout = ({ currentUser }) => {\r\n    return (\r\n      <div className={`theme-${darkMode ? \"dark\" : \"light\"}`}>\r\n        <Navbar onLogout={handleLogout} currentUser={currentUser} />\r\n        <div style={{ display: \"flex\" }}>\r\n          <LeftBar currentUser={currentUser} />\r\n          <div style={{ flex: 6 }}>{<Outlet />}</div>\r\n          <RightBar />\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Routes>\r\n        <Route\r\n          path=\"/\"\r\n          element={\r\n            accessToken ? (\r\n              <Layout currentUser={currentUser} />\r\n            ) : (\r\n              <Navigate to=\"/login\" />\r\n            )\r\n          }\r\n        >\r\n          <Route path=\"/\" element={<Navigate to=\"/home\" />} />\r\n          <Route\r\n            path=\"/home\"\r\n            element={\r\n              <Home\r\n                posts={posts}\r\n                onSubmit={handleSubmit}\r\n                currentUser={currentUser}\r\n              />\r\n            }\r\n          />\r\n\r\n          <Route\r\n            path=\"/profile/:id/posts\"\r\n            element={<Profile currentUser={currentUser} />}\r\n          />\r\n          <Route\r\n            path=\"users/me\"\r\n            element={\r\n              <Profile onSubmit={handleSubmit} currentUser={currentUser} />\r\n            }\r\n          />\r\n          <Route\r\n            path=\"/posts/:id\"\r\n            element={<PostDetailsPage currentUser={currentUser} />}\r\n          />\r\n          <Route\r\n            path=\"/editPost/:id\"\r\n            element={<PostForm currentUser={currentUser} />}\r\n          />\r\n        </Route>\r\n\r\n        <Route path=\"/login\" element={<Login onLogin={handleLogin} />} />\r\n        <Route path=\"/register\" element={<Register />} />\r\n        <Route path=\"/not-found\" element={<NotFound />} />\r\n        <Route path=\"*\" element={<Navigate to=\"/not-found\" />} />\r\n      </Routes>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}